class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        color = [-1] * n
        color_id = 0

        def dfs(node, c):
            color[node] = c
            for nei in range(n):
                if graph[node][nei] == 1 and color[nei] == -1:
                    dfs(nei, c)

        for i in range(n):
            if color[i] == -1:
                dfs(i, color_id)
                color_id += 1

        size = [0] * color_id
        for c in color:
            size[c] += 1

        infected = [0] * color_id
        for node in initial:
            infected[color[node]] += 1

        initial.sort()
        result = initial[0]
        max_saved = -1

        for node in initial:
            c = color[node]
            if infected[c] == 1:
                if size[c] > max_saved:
                    max_saved = size[c]
                    result = node

        return result

